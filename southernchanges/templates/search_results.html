{% extends "base.html" %}
{% load get_item %}

{% block title %}Search{% endblock %}
{% block content %}
{% include "browse-head.html" %}
<div class="content">

<p><b>Search results for texts where:</b></p>
{% if keyword %}
<li>document contains keywords '{{keyword}}'</li>
{% endif %}
{% if author %}
<li>author matches '{{author}}'</li>
{% endif %}
{% if title %}
<li>title matches '{{title}}'</li>
{% endif %}
{% if article_date %}
<li>date matches '{{article_date}}'</li>
{% endif %}

<hr>

{% if server_error %}{{ server_error }}{% endif %}

{% if searchform.is_valid %}
    
<table class="searchnav">
  <tr>
      <td width="25%">
    {% if articles_paginated.number >= 3 %}
        <a href="?page=1&keyword={{keyword}}&title={{title}}&author={{author}}&article_date={{date}}">&lt;&lt;First</a>
    {% endif %}
    </td>
    <td width="25%">
    {% if articles_paginated.has_previous %}
        <a href="?page={{ articles_paginated.next_page_number }}&keyword={{keyword}}&title={{title}}&author={{author}}&article_date={{date}}">&lt;Previous</a>
    {% endif %}
    </td>
    {% if articles_paginated.has_next %}
    <td width="25%">
        <a href="?page={{ articles_paginated.next_page_number }}&keyword={{keyword}}&title={{title}}&author={{author}}&article_date={{date}}">Next&gt;</a>
    </td>
    <td width="25%">
        <a href="?page={{ articles_paginated.next_page_number }}&keyword={{keyword}}&title={{title}}&author={{author}}&article_date={{date}}">Last&gt;&gt;</a>
    </td>
    {% endif %}
  </tr>
</table>

<form align="right" id="jumpnav" action="{% url "search" %}">
<select name="page" onchange="submit();">
  {% for page in articles_paginated.paginator.page_range %}
  {% if page == articles_paginated.number %}
  <option value="{{page}}" selected="selected">{{ range_lookup|get_item:page }}</option>
  {% else %}
    <option value="{{page}}">{{ range_lookup|get_item:page }}</option>
  {% endif %}
    {% endfor %}
</select>
<input name="keyword" type="hidden" value="{{keyword}}">
<input name="author" type="hidden" value="{{author}}">
<input name="title" type="hidden" value="{{title}}">
<input name="date" type="hidden" value="{{article_date}}">
</form>



<p>{{ articles_paginated.paginator.count }} matches found</p>
<p>Click on the number of hits to see your search terms in context. Click on the title to view the whole article. Click on the author name to view more articles by that author.</p>

<table class="browse">
  <thead style="font-size:small;">
    <tr>
      <th class="num" style="text-align:left">#</th>
      <th style="text-align:left">Title</th>
      <th style="text-align:left">Author</th>
      <th style="text-align:left">Date</th>
    <tr/>
  </thead>
  <tbody align="left" valign="top" style="font-size:small;">  
  {% for article in articles_paginated.object_list %}
    <tr>
      <td class="num" width="4%">{{forloop.counter|add:articles_paginated.start_index|add:-1}}.</td>


      <td class="title">
	<a href="{% url "article_display" article.issue_id article.id %}{% if keyword %}?keyword={{ keyword }}{% endif %}">{{article.head}}</a>
      </td>


      <td class="author" width="20%">
	<a href="{% url "search" %}?author={{article.author}}">{{article.author}}</a>
      </td>
      <td class="date" width="25%">{{article.pages}}</td>
    </tr>
  {% endfor %}
    </tbody>
</table>
 
{% endif %}
</div>
{% endblock %}